<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ÙØ±Ù… Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø·Ø¨ÛŒØ¹ÛŒ Ø³Ù‡Ø§</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600&display=swap');
*{box-sizing:border-box;margin:0;padding:0;font-family:'Vazirmatn',sans-serif}
html,body{height:100%;background:#000;color:#eaeaea;-webkit-font-smoothing:antialiased}

/* ØµÙØ­Ù‡ Ø®ÙˆØ´â€ŒØ¢Ù…Ø¯ */
.start-screen{
  min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;
  text-align:center;position:relative;background:url('https://i.postimg.cc/w3rR2sLn/green-nature.jpg') no-repeat center/cover;
}
.start-screen::before{content:"";position:absolute;inset:0;background:rgba(0,0,0,0.6);backdrop-filter:blur(4px);z-index:0}
.start-screen *{position:relative;z-index:1}
.start-title{font-size:1.8rem;font-weight:700;background:linear-gradient(90deg,#fff,#e0c8ff,#fff7db);
  -webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 0 12px rgba(255,255,255,0.12);opacity:0;
  animation:fadeSlide .9s ease forwards}
.start-sub{margin-top:12px;font-size:1.02rem;color:#fff8ee;opacity:0;animation:fadeSlide 1s ease .6s forwards}
@keyframes fadeSlide{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
.start-buttons{margin-top:28px;display:flex;flex-direction:column;gap:12px;opacity:0;animation:fadeSlide 1s ease 1.2s forwards}
.start-buttons button{padding:12px 22px;border-radius:12px;border:0;font-weight:600;background:linear-gradient(135deg,#c1a4ff,#ffe29f,#c1ffd7);
  color:#111;box-shadow:0 8px 30px rgba(0,0,0,0.25);cursor:pointer}
.start-buttons button:active{transform:translateY(1px)}
.instagram-id{position:absolute;right:18px;bottom:14px;color:#fff;font-size:0.92rem;z-index:2}
.instagram-id a{color:#fff;text-decoration:none;font-weight:600}

/* ÙØ±Ù… Ø³ÙØ§Ø±Ø´ */
.form-container{display:none;min-height:100vh;align-items:center;justify-content:flex-start;padding:50px 18px 90px;
  background:radial-gradient(circle at top,#001a12,#000)}
form{
  width:100%;max-width:720px;margin:0 auto;background:rgba(10,20,10,0.95);
  border-radius:18px;padding:28px 20px;border:1px solid rgba(0,255,128,0.12);
  box-shadow:0 10px 40px rgba(0,0,0,0.6), inset 0 0 40px rgba(0,255,128,0.02);
}
.welcome{text-align:center;color:#aaffd4;font-weight:700;font-size:1.4rem;line-height:1.35;margin-bottom:6px;
  animation:fadeInWelcome .9s ease .2s both, glow 2s ease-in-out infinite alternate}
@keyframes fadeInWelcome{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
@keyframes glow{0%{text-shadow:0 0 6px rgba(170,255,212,0.3)}100%{text-shadow:0 0 14px rgba(0,255,150,0.25)}}
.welcome-sub{text-align:center;color:#b2f7cf;font-size:1rem;margin-bottom:14px}

/* ÙÛŒÙ„Ø¯Ù‡Ø§ */
label{
  display:flex;
  align-items:center;
  gap:6px;
  color:#a8ffe2;
  font-weight:600;
  font-size:0.9rem;
  margin-top:10px;
  line-height:1.1;
  width:100%;
}
.input-field,textarea.input-field{
  width:100%;
  padding:8px 10px;
  border-radius:8px;
  border:1px solid rgba(0,255,128,0.15);
  background:rgba(255,255,255,0.05);
  color:#eaffea;
  margin-top:4px;
  font-size:0.93rem;
  line-height:1.3;
  box-shadow:inset 0 1px 2px rgba(0,0,0,0.4);
}
textarea.input-field{min-height:70px}

.products-section{margin-top:36px;margin-bottom:6px}
.products-section h3{color:#80ffd4;font-weight:800;font-size:1.08rem;text-align:center;padding-top:6px}
.product{margin-top:18px;padding:8px 6px;border-radius:10px}
.product label{font-size:0.98rem;margin-bottom:6px;display:block;color:#cffff1}
.product-row{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
.qty{width:86px;padding:9px;border-radius:8px;border:1px solid rgba(0,255,128,0.12);
  background:rgba(255,255,255,0.03);color:#e8ffea;text-align:center;font-size:0.95rem}
.amount-options{display:flex;gap:16px;align-items:center;flex:1;justify-content:flex-start;flex-wrap:wrap}
.amount-options input[type="checkbox"]{width:20px;height:20px;margin:0 6px 0 0;accent-color:#00e676}
.amount-options label{font-size:0.9rem;color:#c8ffc8;display:flex;align-items:center;gap:6px}
.big-gap{margin-top:28px}
.description{margin-top:28px;margin-bottom:22px}
.btn{display:block;width:100%;padding:14px;border-radius:12px;border:0;font-weight:700;
  margin-top:14px;font-size:1.02rem;cursor:pointer;transition:0.3s}
.btn-primary{background:linear-gradient(135deg,#00e676,#00c853);color:#06120b}
.btn-whatsapp{background:linear-gradient(135deg,#25D366,#128C7E);color:#fff;text-align:center;text-decoration:none;margin-top:20px}
.btn:hover{opacity:0.9}
</style>
</head>
<body>

<!-- ØµÙØ­Ù‡ Ø§ÙˆÙ„ -->
<div class="start-screen" id="startScreen">
  <h1 class="start-title">Ø¨Ù‡ Ø¯Ù†ÛŒØ§ÛŒ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø·Ø¨ÛŒØ¹ÛŒ Ø³Ù‡Ø§ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ ğŸŒ¿</h1>
  <div class="start-sub">Ø³Ù‡Ø§ØŒ Ù†ÙˆØ±ÛŒ Ø§Ø² Ø¯Ù„ Ø·Ø¨ÛŒØ¹Øª Ø§Ø³Øª Ú©Ù‡ Ø³Ù„Ø§Ù…ØªÛŒ Ø±Ø§ Ú†ÙˆÙ† Ù†Ø³ÛŒÙ… Ø¨Ø± Ø¬Ø§Ù† Ù…ÛŒâ€ŒÙ†Ø´Ø§Ù†Ø¯ âœ¨</div>
  <div class="start-buttons">
    <button onclick="showForm()">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ ÙØ±Ù… Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´</button>
    <button>Ø¢Ø´Ù†Ø§ÛŒÛŒ Ø¨Ø§ Ù…Ø­ØµÙˆÙ„Ø§Øª</button>
  </div>
  <div class="instagram-id">Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø§Ø²Ù†Ø¯Ù‡Ø› <a href="https://www.instagram.com/bahram_sh321" target="_blank">bahram_sh321@</a></div>
</div>

<!-- ÙØ±Ù… Ø³ÙØ§Ø±Ø´ -->
<div class="form-container" id="orderForm" style="display:none">
  <form id="mainForm">
    <div class="welcome">ğŸŒ¿ Ø¨Ù‡ Ø¨Ø®Ø´ Ø«Ø¨Øª Ø³ÙØ§Ø±Ø´ Ù…Ø­ØµÙˆÙ„Ø§Øª Ø·Ø¨ÛŒØ¹ÛŒ<br>ğŸ’ Ø³Ù‡Ø§ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯</div>
    <div class="welcome-sub">Ù„Ø·ÙØ§ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø®ÙˆØ¯ Ùˆ Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙØ§Ø±Ø´â€ŒØªØ§Ù† Ø±Ø§ Ø¯Ù‚ÛŒÙ‚ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</div>

    <label>ğŸ‘¤ Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
    <input class="input-field" id="name" type="text" required>

    <label>ğŸ“± Ø´Ù…Ø§Ø±Ù‡ ØªÙ…Ø§Ø³</label>
    <input class="input-field" id="phone" type="tel" required>

    <label>ğŸ  Ø¢Ø¯Ø±Ø³ Ú©Ø§Ù…Ù„</label>
    <textarea class="input-field" id="address"></textarea>

    <label>âœ‰ï¸ Ú©Ø¯ Ù¾Ø³ØªÛŒ</label>
    <input class="input-field" id="postalCode" type="text">

    <div class="products-section">
      <h3>ğŸµ Ø¨Ø®Ø´ Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ø­ØµÙˆÙ„ (Ù†ÙˆØ±Ù‡ Ø³Ù‡Ø§)</h3>

      <div class="product"><label>ğŸŸ¢ Ø¨Ø³ØªÙ‡ ÛµÛ°Û° Ú¯Ø±Ù…ÛŒ Ø³Ø¨Ø² Ø³Ù‡Ø§</label>
        <div class="product-row"><input class="qty" type="number" min="0" placeholder="ØªØ¹Ø¯Ø§Ø¯">
          <div class="amount-options"><label><input type="checkbox" data-choice="carton">Ú©Ø§Ø±ØªÙ†</label>
          <label><input type="checkbox" data-choice="pack">Ø¨Ø³ØªÙ‡</label></div></div></div>

      <div class="product"><label>ğŸŸ¡ Ø¬Ø¹Ø¨Ù‡ Û²ÛµÛ° Ú¯Ø±Ù…ÛŒ Ø³Ø§Ø´Ù‡â€ŒÛŒ Ø³Ù‡Ø§</label>
        <div class="product-row"><input class="qty" type="number" min="0" placeholder="ØªØ¹Ø¯Ø§Ø¯">
          <div class="amount-options"><label><input type="checkbox" data-choice="carton">Ú©Ø§Ø±ØªÙ†</label>
          <label><input type="checkbox" data-choice="pack">Ø¨Ø³ØªÙ‡</label></div></div></div>

      <div class="product"><label>ğŸŸ¤ Ø¨Ø³ØªÙ‡ ÛŒÚ© Ú©ÛŒÙ„ÙˆÛŒÛŒ Ø¨Ø§Ú©Ø³ Ù¾ÙˆÚ†</label>
        <div class="product-row"><input class="qty" type="number" min="0" placeholder="ØªØ¹Ø¯Ø§Ø¯">
          <div class="amount-options"><label><input type="checkbox" data-choice="carton">Ú©Ø§Ø±ØªÙ†</label>
          <label><input type="checkbox" data-choice="pack">Ø¨Ø³ØªÙ‡</label></div></div></div>

      <div class="product"><label>âœ¨ Ø¨Ø³ØªÙ‡ ÛµÛ°Û° Ú¯Ø±Ù…ÛŒ Ù¾Ø§Ú©Øª Ø·Ù„Ø§ÛŒÛŒ Ù¾Ù†Ø¬Ø±Ù‡ Ø¯Ø§Ø±</label>
        <div class="product-row"><input class="qty" type="number" min="0" placeholder="ØªØ¹Ø¯Ø§Ø¯">
          <div class="amount-options"><label><input type="checkbox" data-choice="carton">Ú©Ø§Ø±ØªÙ†</label>
          <label><input type="checkbox" data-choice="pack">Ø¨Ø³ØªÙ‡</label></div></div></div>

      <div class="product"><label>âšª Ø¨Ø³ØªÙ‡ ÛŒÚ© Ú©ÛŒÙ„ÙˆÛŒÛŒ Ù…Ø¹Ù…ÙˆÙ„ÛŒ (Ø³Ø§Ø¯Ù‡)</label>
        <div class="product-row"><input class="qty" type="number" min="0" placeholder="ØªØ¹Ø¯Ø§Ø¯">
          <div class="amount-options"><label><input type="checkbox" data-choice="carton">Ú©Ø§Ø±ØªÙ†</label>
          <label><input type="checkbox" data-choice="pack">Ø¨Ø³ØªÙ‡</label></div></div></div>
    </div>

    <label>ğŸ“ ØªÙˆØ¶ÛŒØ­Ø§Øª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
    <textarea class="input-field" id="notes"></textarea>

    <button class="btn btn-primary" type="submit">ğŸ“¦ Ø«Ø¨Øª Ùˆ Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´</button>
    <a href="https://wa.me/989037122660" target="_blank" class="btn btn-whatsapp">ğŸ’¬ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ ÙˆØ§ØªØ³Ø§Ù¾</a>
  </form>
</div>

<script>
function showForm(){
  document.getElementById('startScreen').style.display='none';
  document.getElementById('orderForm').style.display='flex';
}

document.addEventListener('change', (e)=>{
  if(e.target.type==='checkbox'){
    const group=e.target.closest('.product');
    if(group){
      group.querySelectorAll('input[type="checkbox"]').forEach(c=>{if(c!==e.target)c.checked=false;});
    }
  }
});

document.getElementById('mainForm').addEventListener('submit', async (e)=>{
  e.preventDefault();

  const name=document.getElementById('name').value.trim();
  const phone=document.getElementById('phone').value.trim();
  const address=document.getElementById('address').value.trim();
  const notes=document.getElementById('notes').value.trim();

  const products=[...document.querySelectorAll('.product')].map(p=>{
    const title=p.querySelector('label').innerText;
    const qtyVal=p.querySelector('.qty').value;
    const qty=qtyVal===""?0:Number(qtyVal);
    const checked=p.querySelector('input[type="checkbox"]:checked');
    return qty>0?`${title} - ${qty} Ø¹Ø¯Ø¯ (${checked?checked.dataset.choice:'Ø¨Ø¯ÙˆÙ† Ø§Ù†ØªØ®Ø§Ø¨'})`:null;
  }).filter(Boolean);

  const summary=`
  <div class='confirm-box'>
    <h3>ØªØ£ÛŒÛŒØ¯ Ù†Ù‡Ø§ÛŒÛŒ Ø³ÙØ§Ø±Ø´ ğŸŒ¿</h3>
    <p><strong>Ù†Ø§Ù…:</strong> ${name}</p>
    <p><strong>ØªÙ…Ø§Ø³:</strong> ${phone}</p>
    <p><strong>Ø¢Ø¯Ø±Ø³:</strong> ${address}</p>
    <p><strong>Ø³ÙØ§Ø±Ø´Ø§Øª:</strong><br>${products.join('<br>')}</p>
    <p><strong>ØªÙˆØ¶ÛŒØ­Ø§Øª:</strong> ${notes||'Ù†Ø¯Ø§Ø±Ø¯'}</p>
    <div class='confirm-actions'>
      <button id='confirmSend' class='btn btn-primary'>âœ… ØªØ£ÛŒÛŒØ¯ Ùˆ Ø§Ø±Ø³Ø§Ù„</button>
      <button id='cancelConfirm' class='btn' style='background:#333;color:#eee'>âŒ Ø¨Ø§Ø²Ú¯Ø´Øª Ùˆ ÙˆÛŒØ±Ø§ÛŒØ´</button>
    </div>
  </div>`;

  showModal(summary);

  document.getElementById('confirmSend').onclick=async()=>{
    try{
      const payload={name,phone,address,products,notes};
      const res=await fetch('/api/order',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)});
      const data=await res.json();

      if(res.ok){
        showModal(`<div class='success-box'>âœ… Ø³ÙØ§Ø±Ø´ Ø´Ù…Ø§ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø«Ø¨Øª Ùˆ Ø§Ø±Ø³Ø§Ù„ Ø´Ø¯.<br>Ø¨Ù‡â€ŒØ²ÙˆØ¯ÛŒ Ú©Ø§Ø±Ø´Ù†Ø§Ø³Ø§Ù† Ù…Ø§ Ø¨Ø§ Ø´Ù…Ø§ ØªÙ…Ø§Ø³ Ø®ÙˆØ§Ù‡Ù†Ø¯ Ú¯Ø±ÙØª.<br><span>Ø§Ø² Ø§Ø¹ØªÙ…Ø§Ø¯ Ø´Ù…Ø§ Ø³Ù¾Ø§Ø³Ú¯Ø²Ø§Ø±ÛŒÙ….</span></div>`);
        e.target.reset();
        setTimeout(()=>{closeModal();document.getElementById('orderForm').style.display='none';document.getElementById('startScreen').style.display='flex';},3500);
      }else{
        showModal(`<div class='error-box'>âŒ ${data.message||'Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±Ø³Ø§Ù„ Ø³ÙØ§Ø±Ø´. Ù„Ø·ÙØ§Ù‹ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ ØªÙ„Ø§Ø´ ÙØ±Ù…Ø§ÛŒÛŒØ¯.'}</div>`);
      }
    }catch(err){
      showModal(`<div class='error-box'>âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ø³Ø±ÙˆØ±. Ù„Ø·ÙØ§Ù‹ Ø¨Ø¹Ø¯Ø§Ù‹ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ù…ØªØ­Ø§Ù† Ú©Ù†ÛŒØ¯.</div>`);
    }
  };

  document.getElementById('cancelConfirm').onclick=closeModal;
});

function showModal(content){
  let overlay=document.getElementById('overlay');
  if(!overlay){
    overlay=document.createElement('div');
    overlay.id='overlay';
    overlay.innerHTML=`<div class='modal'>${content}</div>`;
    document.body.appendChild(overlay);
  }else{
    overlay.querySelector('.modal').innerHTML=content;
    overlay.style.display='flex';
  }
  overlay.classList.add('show');
}

function closeModal(){
  const overlay=document.getElementById('overlay');
  if(overlay){overlay.style.display='none';}
}
</script>

<style>
#overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.75);
display:flex;align-items:center;justify-content:center;z-index:9999;backdrop-filter:blur(6px);animation:fadeIn .3s ease;}
#overlay .modal{background:rgba(20,30,20,0.97);border-radius:16px;padding:24px;color:#d4ffe3;max-width:360px;width:90%;
box-shadow:0 0 25px rgba(0,255,128,0.15);text-align:right;line-height:1.6;}
.confirm-box h3{color:#80ffd4;text-align:center;margin-bottom:10px}
.confirm-actions{display:flex;gap:10px;margin-top:16px;justify-content:center}
.success-box,.error-box{text-align:center;font-weight:600;padding:20px;border-radius:12px;line-height:1.8;}
.success-box{background:rgba(0,255,128,0.1);color:#b2ffca}
.error-box{background:rgba(255,50,50,0.1);color:#ffb2b2}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
</style>

</body>
</html>
